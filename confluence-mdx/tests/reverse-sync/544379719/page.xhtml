<h2>Overview</h2><p>QueryPie 에서는 데이터베이스 등록 및 관리를 위한 AWS 연동을 지원합니다. AWS 내의 리소스를 동기화하여 QueryPie  에서 관리하는 데이터베이스로 등록하고, 사용자 및 그룹에 동기화해온 데이터베이스에 대한 접근 권한을 부여하고 정책을 설정할 수 있습니다.</p><p /><h2>QueryPie 에서 AWS 연동 정보 등록하기</h2><ac:structured-macro ac:name="info" ac:schema-version="1" ac:macro-id="270ff6a1-2b46-4fc7-9db6-fa269b5be516"><ac:rich-text-body><p>11.3.0에서 특정 태그가 있는 리소스만 동기화 할 수 있도록 Search Filter 기능이 추가 되었습니다.</p></ac:rich-text-body></ac:structured-macro><ac:image ac:align="center" ac:alt="image-20241217-084317.png" ac:custom-width="true" ac:layout="center" ac:original-height="699" ac:original-width="739" ac:width="739"><ri:attachment ri:filename="image-20241217-084317.png" ri:version-at-save="1" /><ac:caption><p>Administrator &gt; Databases &gt; Connection Management &gt; Cloud Providers</p></ac:caption><ac:adf-mark color="#091e4224" key="border" size="1" /></ac:image><p /><ol start="1"><li><p>Database 설정 메뉴에서 Cloud Provider 메뉴로 이동합니다.</p></li><li><p>우측 상단의 <code>Create Provider</code> 버튼을 클릭합니다.</p></li><li><p>Name 항목에 해당 프로바이더를 구분할 수 있는 이름을 입력합니다.</p></li><li><p><strong>Cloud Provider</strong> 항목에서 Amazon Web Services 를 선택합니다.</p></li><li><p><strong>Region</strong> 항목에서 동기화하고자 하는 리소스의 리전을 선택합니다.</p></li><li><p>리소스를 동기화하기 위해 필요한 Credential 정보를 입력합니다.</p><ul><li><p>각각의 <strong>Credential</strong> 방식에 대한 설명은 하단의 <strong>Credential 타입별 인증 방식 설정하기</strong>를 참고합니다.</p></li></ul></li><li><p><strong>Database Type Filter</strong> 항목에서 동기화하고자 하는 리소스들을 선택합니다. </p></li><li><p><strong>Search Filter</strong> 를 사용하여 동기화하고자 하는 일부 유형의 리소스 목록을 가져올 수 있습니다.</p><ol start="1"><li><p>Search Filter는 AWS의 검색 방식과 동일하게 작동합니다. 이름, 호스트, OS, 태그 등의 값을 필터로 사용할 수 있으며 아래 순서대로 Enter 키를 활용하여 검색 조건 및 필터를 편리하게 입력할 수 있습니다.</p><ol start="1"><li><p>Key 값 입력 후 Enter &rarr; 검색 조건 선택 후 Enter &rarr; Value 값 입력 후 Enter</p></li></ol></li></ol></li><li><p><strong>Replication Frequency</strong> 항목에서 동기화 방식을 선택합니다.</p><ol start="1"><li><p>Manual : 동기화를 하고자 하는 시점에만 수동으로 동기화하는 방식입니다.</p></li><li><p>Scheduling : 주기적인 스케줄링을 통해 리소스를 동기화하는 방식입니다. Cron Expressions를 제공합니다.</p></li></ol></li><li><p><strong>Auto Configuration Upon Initial Synchronization </strong>Cloud Provider에서 처음 동기화하는 DB의 일부 값을 사용자가 지정 할 수 있습니다. 초기값 설정은 Cloud Provider 저장 후 수정할 수 없습니다. 이 설정의 변경이 필요한 경우, Cloud Provider 삭제 후 다시 등록을 해야 합니다.</p><ul><li><p>Tag : 동기화된 DB에 자동으로 태그를 추가할 수 있습니다.</p><ul><li><p>태그 값에 <code>{vpcid}</code>를 입력하면, 해당 DB가 속한 Cloud의 VPC ID가 자동으로 채워집니다.</p></li><li><p>예: 태그 Key를 &quot;Network&quot;로 설정하고 Value를 <code>{vpcid}</code>로 입력하면, DB가 &quot;vpc-1a2b3c4d&quot; VPC에 있을 경우 &quot;Network: vpc-1a2b3c4d&quot; 태그가 자동 생성됩니다.</p></li></ul></li></ul></li><li><p><code>Save</code> 버튼을 클릭하여 Cloud Provider 를 저장합니다.</p></li></ol><p /><h2>Credential 타입별 인증 방식 설정하기</h2><ac:image ac:align="center" ac:alt="image-20240725-043642.png" ac:custom-width="true" ac:layout="center" ac:original-height="1912" ac:original-width="3452" ac:width="760"><ri:attachment ri:filename="image-20240725-043642.png" ri:version-at-save="2" /><ac:caption><p>Administrator &gt; Databases &gt; Connection Management &gt; Cloud Provider &gt; Create Provider</p></ac:caption></ac:image><p /><ul><li><p><strong>Default Credentials (Instance Profile)</strong> : QueryPie 서버가 같은 AWS 계정에 설치되어 있는 경우, QueryPie가 설치된 EC2 인스턴스 IAM 권한에 정책을 할당하여 같은 AWS 내의 리소스를 동기화할 수 있습니다. 필요한 리소스에 맞는 정책을 할당해주세요.</p></li><li><p><strong>Cross Account Role</strong> : IAM 역할을 생성하여 다른 AWS 계정의 리소스를 동기화할 수 있습니다. 화면에 표시된 스텝에 따라 동기화를 위한 권한을 생성하고 정책을 할당해주세요. (해당 Credential 을 통해 리소스를 동기화하기 위해서는  환경변수 파일 <strong>AWS_ACCOUNT_ID</strong> 항목에 QueryPie 가 설치된 AWS 계정을 설정해야 합니다)</p></li><li><p><strong>Access Key</strong> : <code>Synchronize</code> 버튼 클릭 시 AWS 계정의 access key 및 secret key를 입력하는 수동 동기화 방식을 기본 제공합니다. <br />QueryPie 10.2.2 부터 &ldquo;Save Credential for Synchronization&rdquo; 옵션을 제공하여 Credential type로 access key를 사용 할 때도 스케줄을 통한 동기화가 가능하도록 개선되었습니다.  <strong><span style="color: rgb(191,38,0);"> </span></strong></p></li></ul><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="b160d97f-6cfb-4257-bc61-371121e05598"><ac:rich-text-body><p><strong>Save Credential for Synchronization 옵션</strong></p><ac:image ac:align="center" ac:alt="image-20241220-095857.png" ac:custom-width="true" ac:layout="center" ac:original-height="276" ac:original-width="653" ac:width="545"><ri:attachment ri:filename="image-20241220-095857.png" ri:version-at-save="2" /><ac:caption><p>Save Credential for Synchronization</p></ac:caption></ac:image><ul><li><p><strong><span style="color: rgb(191,38,0);">이 옵션을 활성화해서 저장한 동기화 설정은 동기화 설정 상세페이지에서 이 옵션을 비활성 할 수 없으므로 신중히 선택해야 합니다. 저장된 credential은 교체할 수 없습니다. 다른 credential을 사용해야 하는 상황이라면 동기화 설정을 새로 생성해야 합니다. credential 변경이 필요한 경우 기존과 동일한 IAM 권한이 할당된 credential을 생성하고 동기화 설정을 새로 만든 뒤 기존 동기화 설정을 삭제하는 것을 권장합니다.</span></strong></p></li><li><p>이 옵션이 활성화 되어 있지 않은 상태로 저장된 동기화 설정은 상세페이지에서 체크박스를 체크하는 것으로 옵션을 활성화 할 수 있습니다. </p></li><li><p>이 옵션이 활성화 되어 있으면 동기화를 수동으로 할 수도 있고 스케줄을 지정할 수도 있습니다.</p></li></ul></ac:rich-text-body></ac:structured-macro><p /><ac:structured-macro ac:name="info" ac:schema-version="1" ac:macro-id="fe8db068-777d-4175-8b1d-b0d4a587650d"><ac:rich-text-body><p><strong>각 데이터베이스 리소스 동기화에 필요한 정책</strong></p><ul><li><p>RDS : AmazonRDSReadOnlyAccess</p></li><li><p>DynamoDB : AmazonDynamoDBFullAccess</p></li><li><p>Redshift : AmazonRedshiftReadOnlyAccess</p></li><li><p>Athena : AmazonAthenaFullAccess, AmazonS3DFullAccess</p></li><li><p>Redis : AmazonElastiCacheFullAccess</p></li></ul></ac:rich-text-body></ac:structured-macro><p /><h2>등록된 AWS Cloud Provider 동기화 및 관리</h2><p /><ac:image ac:align="center" ac:alt="image-20241220-100746.png" ac:custom-width="true" ac:layout="center" ac:original-height="884" ac:original-width="1030" ac:width="760"><ri:attachment ri:filename="image-20241220-100746.png" ri:version-at-save="1" /><ac:caption><p>Administrator &gt; Databases &gt; Connection Management &gt; Cloud Providers &gt; Details</p></ac:caption></ac:image><p /><ol start="1"><li><p>Database 설정 메뉴에서 Cloud Provider 메뉴로 이동합니다.</p></li><li><p>등록한 Cloud Provider 를 클릭하여 세부 정보 화면으로 들어갑니다.</p></li><li><p>우측 상단의 <code>Synchronize</code> 버튼을 클릭하면 AWS 에서 리소스를 동기화할 수 있습니다.</p></li><li><p>표시되는 Synchronization Log 에서 동기화 진행 상황을 확인할 수 있고, Administrator &gt; General &gt; Systems &gt; Jobs 메뉴에서도 동기화 히스토리를 확인할 수 있습니다.</p></li><li><p>Cloud Provider 를 한번 등록하고 나면 Provider 기본 정보 및 인증 정보는 변경할 수 없습니다.</p><ol start="1"><li><p>Name: 변경 가능</p></li><li><p>Cloud Provider: 변경 불가</p></li><li><p>Region: 변경 불가</p></li><li><p>Credential: 변경 불가</p><ol start="1"><li><p>&ldquo;Save Credential for Synchronization&rdquo; : 비활성화 상태는 활성화로 변경할 수 있으나 활성화 상태를 비활성화로 전환 불가</p></li></ol></li><li><p>Role ARN: 변경 불가</p></li><li><p>Database Type Filter: 변경 가능</p></li><li><p>Replication Frequency: 변경 가능</p></li></ol></li></ol><ac:structured-macro ac:name="note" ac:schema-version="1" ac:macro-id="30dc58c3-44ad-4145-9900-e91a7f822aad"><ac:rich-text-body><p>&ldquo;Save Credential for Synchronization&rdquo; 옵션이 활성화 되어 있지 않은 상태로 저장된 동기화 설정은 상세페이지에서 체크박스를 체크하는 것으로 옵션을 활성화 할 수 있습니다. 새로 생성할 때와 마찬가지로 이 설정은 <strong>활성화 한 뒤 다시 비활성화 할 수 없으므로</strong> 신중히 선택해야 합니다.</p></ac:rich-text-body></ac:structured-macro><h2>동기화 가능한 리소스 항목</h2><ul><li><p>Amazon RDS (MySQL, MariaDB, PostgreSQL, SQL Server, Oracle), DynamoDB, Redshift, DocumentDB, Athena, Redis (ElastiCache)</p></li></ul>