import { Callout } from 'nextra/components'

## Overview

QueryPie에서는 웹 브라우저를 통해 쿼리를 실행하고 데이터를 조회할 수 있는 웹 SQL 에디터를 제공합니다.


## 접근 권한이 있는 데이터베이스 접속

개별 사용자 또는 그룹에 접근 권한이 부여된 데이터베이스 커넥션 목록을 확인할 수 있으며, 작업을 수행할 커넥션을 선택하여 데이터베이스에 접속할 수 있습니다.

<figure data-layout="center" data-align="center">
![QueryPie Web &gt; Database Access Control &gt; Databases](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20240731-114320.png)
<figcaption>
QueryPie Web &gt; Database Access Control &gt; Databases
</figcaption>
</figure>

1. QueryPie 로그인 후 상단 메뉴 바 옵션에서 `Databases`를 클릭합니다. 
2. 좌측 패널에 접속 가능한 데이터베이스 커넥션들이 표시됩니다.
3. 접속하고자 하는 커넥션을 클릭하면 우측에 세부 정보가 표시되며, `Connect`버튼을 클릭하여 접속합니다.

필요한 커넥션이 표시되지 않는 경우, Workflow &gt; DB Access Request를 통해 접근 권한을 요청할 수 있습니다.

## 웹 SQL 에디터 사용하기

에디터는 좌측 개체 패널, 상단 툴바, 가운데 SQL 에디터, 우측 개체 정보 패널로 구성되어 있습니다.

### 1. 좌상단 개체 패널

<figure data-layout="center" data-align="center">
![SQL Editor &gt; Connection Panel](/user-manual/database-access-control/connecting-with-web-sql-editor/screenshot-20240802-141439.png)
<figcaption>
SQL Editor &gt; Connection Panel
</figcaption>
</figure>

* `Change connection` : 화살표 버튼을 통해 연결 중인 커넥션 확인 및 연결 중인 다른 커넥션으로 변경 가능합니다.
* `Connection Management` : 기존 연결이 유지된 상태로 Databases 커넥션 리스트로 이동이 가능합니다.
* `Disconnect` : 연결 해제 버튼을 통해 현재 연결 중인 커넥션의 연결을 끊을 수 있습니다. 

### 2. 좌측 개체 패널

<figure data-layout="center" data-align="center">
![SQL Editor &gt; Connection Panel](/user-manual/database-access-control/connecting-with-web-sql-editor/screenshot-20240802-141927.png)
<figcaption>
SQL Editor &gt; Connection Panel
</figcaption>
</figure>

*  **데이터베이스 변경**  : 현재 접속한 데이터베이스를 변경할 수 있습니다. (최초 연결 시 기본 설정 데이터베이스에 접속)
*  **개체 정보 검색**  : 데이터베이스 내의 스키마 / 테이블 / 뷰 / 이벤트 / 함수 / 프로시저 / 트리거 등을 검색할 수 있습니다.
*  **개체 정보 조회**  : 데이터베이스 내의 스키마 / 테이블 / 뷰 / 이벤트 / 함수 / 프로시저 / 트리거 등을 확인할 수 있습니다.
*  **개체 정보 갱신**  : 데이터베이스 내의 스키마 / 테이블 / 뷰 / 이벤트 / 함수 / 프로시저 / 트리거 등을 클릭 시, 우측 `새로고침` 버튼이 활성화되어 개체 정보를 갱신해올 수 있습니다. 
*  **개별 개체 정보 갱신**  : 개별 개체 정보 또한 우클릭 후 `Reload Object` 버튼을 클릭하여 동일하게 갱신할 수 있습니다.

### 3. 상단 툴바

<figure data-layout="center" data-align="center">
![QueryPie Web &gt; Database Access Control &gt; SQL Editor &gt; Toolbar](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20240731-115955.png)
<figcaption>
QueryPie Web &gt; Database Access Control &gt; SQL Editor &gt; Toolbar
</figcaption>
</figure>

* `Run SQL` : 작성한 쿼리를 실행할 수 있습니다. 기본적으로 작성된 전체 쿼리가 실행됩니다.
* `Stop` : 실행 중인 쿼리를 중지할 수 있습니다.
* `Object Panel` : 좌측 개체 패널 접기/열기 기능을 옵션으로 제공합니다.
* `Open` : SQL 파일을 불러올 수 있습니다.
* `Save` : SQL 파일을 저장할 수 있습니다. 
    * Query Sharing 설정이 On인 경우 Git Repository에 SQL 파일이 저장됩니다.
* `Undo` : 작성 중인 쿼리 기준으로 실행 취소 할 수 있습니다.
* `Redo` : 실행 취소한 작업을 다시 실행할 수 있습니다.
* `Format` : 작성 중인 쿼리를 정렬할 수 있습니다.
* `Auto commit` : 수행한 작업 쿼리를 자동으로 커밋을 활성화합니다.
    * `Commit` : 수행한 작업 쿼리를 수동으로 확정합니다.
    * `List` : 작업 확정되지 않은 쿼리 목록을 나열합니다.
    * `Rollback` : 직전 커밋 직후의 단계로 회귀를 수행합니다.
* `Import` : 데이터를 SQL/CSV/Excel 파일로 가져와 데이터베이스에 저장할 수 있습니다.
* `Export` : 데이터를 SQL/CSV/JSON/Excel 파일로 다운로드 받을 수 있습니다.
* `SQL Request` : 에디터에 작성된 쿼리를 태워 SQL Request 워크플로 페이지로 이동합니다. 


<figure data-layout="center" data-align="center">
![SQL Editor &gt; Editor Tab & Result](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20240802-052240.png)
<figcaption>
SQL Editor &gt; Editor Tab & Result
</figcaption>
</figure>

* 쿼리 작성 시 자동완성을 지원하며, 컨텍스트 메뉴를 통한 작업 및 단축키 사용이 가능합니다.
* `Limit`: 쿼리 실행 시 결과 출력 행 개수를 제한할 수 있습니다. 기본적으로 1000개로 제한됩니다.
* `Full Screen` : 쿼리 실행 결과를 전체 화면으로 확인할 수 있습니다.
* `Stack/Column View` : 쿼리를 여러 개 실행했을 때, 가로 또는 세로의 분할된 그리드로 결과를 확인할 수 있습니다.

### 3. Queries 패널

<figure data-layout="center" data-align="center">
![SQL Editor &gt; Queries Panel ](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20240802-052539.png)
<figcaption>
SQL Editor &gt; Queries Panel 
</figcaption>
</figure>

* `Queries` : Query Sharing 활성화 시, 연결된 GitHub Repository에서 SQL 쿼리 가져오기/내보내기가 가능합니다. 

<Callout type="info">
해당 기능을 사용하기 위해서는 관리자가 쿼리 공유 설정을 사전에 해야 합니다. ([General](General) &gt;  **쿼리 공유 설정**  참고)
</Callout>

### 4. Object Info 패널

<figure data-layout="center" data-align="center">
![SQL Editor &gt; Object Info Panel ](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20240802-053427.png)
<figcaption>
SQL Editor &gt; Object Info Panel 
</figcaption>
</figure>

* `Data` : 테이블/뷰 개체의 데이터를 확인할 수 있습니다.
* `Structure` : 테이블/뷰 객체의 구조를 확인할 수 있습니다.
* `Index` : 테이블의 인덱스 정보를 확인할 수 있습니다.
* `Relation` : 테이블의 연결 관계를 확인할 수 있습니다.
* `Trigger` : 트리거 정보를 확인할 수 있습니다.
* `Script` : 개체의 스크립트 정보를 확인할 수 있습니다.
* `Info` : 개체의 세부 정보를 확인할 수 있습니다.

### 5. SQL History 패널

<figure data-layout="center" data-align="center">
![SQL Editor &gt; SQL History Panel](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20240802-054007.png)
<figcaption>
SQL Editor &gt; SQL History Panel
</figcaption>
</figure>

* `SQL History` : 실행했던 쿼리 내역을 확인할 수 있습니다. 기록은 최대 3개월까지 보관됩니다.

<Callout type="info">
**Q 웹 에디터에서 실행할 수 있는 쿼리 크기에 제한이 있나요?**

**A. SQL Editor의 경우 아래와 같이 지원됩니다. **

* 단일 쿼리 실행시 1천만자로 제한됩니다.
* 쿼리 에디터 내에서 9999 라인까지 지원합니다.
* 쿼리 에디터 내에서 5mb 크기까지 지원합니다.
* 파일 업로드할 경우, 5mb 크기까지 지원합니다.

**A. Workflow &gt; SQL Request 화면에서 파일을 첨부할 경우는 아래와 같이 지원됩니다. **

* File 타입 선택하여, 파일 첨부를 통한 쿼리 실행 용량 제한 없습니다.
* 단일 쿼리 실행 시 1천만자로 제한됩니다.
* Text 타입 선택하는 경우, 쿼리 에디터 내에서 9999 라인까지 지원합니다.
* Text 타입 선택하는 경우, 쿼리 에디터 내에서 5mb 크기까지 지원합니다.
</Callout>

### 6. 쿼리 수행시 사유입력

Ledger 정책 또는 커넥션 정책에 의해 쿼리를 수행시 사유입력이 강제될 수 있습니다. 이 경우 사용자가 쿼리를 입력하면 사유를 입력하는 팝업이 출력됩니다. 아래 그림과 같이 “Write the reason for this request” 팝업 대화창에 쿼리를 수행하는 사유를 입력하고 `OK` 버튼을 누르면 쿼리 실행 결과가 출력됩니다. 총 300자까지 입력 가능합니다.

<figure data-layout="center" data-align="center">
![image-20241031-233232.png](/user-manual/database-access-control/connecting-with-web-sql-editor/image-20241031-233232.png)
</figure>


