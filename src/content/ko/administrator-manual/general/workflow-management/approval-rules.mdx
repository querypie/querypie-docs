## Overview
결재 규칙(Approval Rules)이란, 관리자가 사전에 설정해 둔 Workflow 승인 프로세스를 의미합니다. 결재 규칙은 요청 유형별로 각각 생성하며, 승인 단계를 1~3단계로 설정하고 각 단계별로 승인자 선택 방식을 설정할 수 있습니다. Approval Rules 페이지에서 제공하는 기능은 다음과 같습니다.

1. **결재 규칙 목록 조회**  : 등록된 결재 규칙 목록을 조회할 수 있습니다. (최근 생성 순)
2. **결재 설정**  : 결재 상신 및 승인 프로세스를 설정합니다.
    1. 자세한 설명은 [Workflow Configurations](Workflow Configurations) 문서를 참고하세요.
3. **결재 규칙 생성**  : 페이지 우측 상단의 `Add Approval Rule` 버튼을 클릭합니다.
4. **상세 정보 확인 및 수정**  : 리스트에서 결재 규칙을 클릭하면 등록된 내용을 확인하고 수정할 수 있습니다.
5. **결재 규칙 삭제**  : 목록에서 체크박스를 선택하면 테이블 헤더에 `Delete` 버튼이 노출되며, 이를 클릭하면 등록된 규칙을 삭제할 수 있습니다.

이 문서에서는 결재 규칙의 생성, 조회, 변경 및 삭제 방법을 안내합니다.



## 결재 규칙 목록 조회하기
Administrator &gt; General &gt; Workflow Management &gt; Approval Rules 메뉴에서 결재 규칙 목록을 조회할 수 있습니다.

<p align="center">
<div>[스크린샷 2024-07-23 오후 4.31.51.png]()</div>
*Administrator &gt; General &gt; Workflow Management &gt; Approval Rules*
</p>



## 결재 규칙 생성하기
Approval Rules 페이지 우측 상단의 `Add Approval Rule` 버튼을 클릭하면 모달이 노출됩니다.

<p align="center">
<div>[image-20250512-121423.png]()</div>
*Administrator &gt; General &gt; Workflow Management &gt; Approval Rules &gt; Add Approval Rule*
</p>

* **Rule Name ** : 결재 규칙을 화면상에서 구별할 수 있는 이름입니다.
* **Request Type**  : 결재 규칙을 추가할 요청 타입을 선택합니다. 결재 규칙은 요청 타입별로 구분됩니다.
    * [ac:emoticon] Request Type은 한번 결재 규칙을 생성하면  **변경할 수 없습니다.**
* **Approval Steps**  : 승인 단계 및 승인자 지정 방식을 설정합니다.
    * `Add Step` 버튼을 클릭하여 승인 단계를 추가할 수 있습니다. 최대 3단계까지 가능합니다.
    * 승인자 지정 방식:
        * **Allow Assignee selection (Admin-Only) ** : 요청자가 직접 승인자를 지정할 수 있으나, Owner 및 해당 요청을 승인할 권한을 가진 관리자만 선택 가능합니다.
        * **Allow Assignee selection (All Users)**  : 요청자가 직접 승인자를 지정할 수 있으며, 모든 사용자를 선택 가능합니다.
            * 이 옵션을 선택할 경우 요청자 본인을 승인자로 지정하는 것을 허용합니다.
        * **Assign Connection Owner** : 요청 시점에 선택한 커넥션의 Connection Owner 가 승인자로 지정됩니다. (Request Type으로 SQL / Export Request를 지정한 경우에만 활성화)
        * **Assign Server Group Owners** : 요청 시점에 선택한 서버 그룹의 Server Group Owner 가 승인자로 지정됩니다. (Request Type으로 Server Access Request / Server Privilege Request를 지정한 경우에만 활성화)
        * **Select Assignees**  : 현재 선택하는 사용자 또는 그룹만이 승인자로 지정되며, 요청 작성 시 승인자 변경이 불가능합니다.
        * **Allow Assignee selection (Attribute-Based)** : 요청자 프로필의 특정 사용자 Attribute 값을 기준으로 승인자를 자동으로 지정합니다.
* **Execution Steps ** : SQL 실행자 지정 방식을 설정합니다. (Request Type으로 SQL / Export Request 을 지정한 경우에만 활성화)
    * **Allow Assignee selection (Admin-Only) ** : 요청자가 직접 실행자를 지정할 수 있으나, Owner 및 해당 요청을 승인할 권한을 가진 관리자만 선택 가능합니다.
    * **Allow Assignee selection (All Users)**  : 요청자가 직접 실행자를 지정할 수 있으며, 모든 사용자를 선택 가능합니다.
        * 이 옵션을 선택할 경우 요청자 본인을 실행자로 지정하는 것을 허용합니다.
    * **Assign Connection Owner** : 요청 시점에 선택한 DB 커넥션의 Connection Owner 가 실행자로 지정됩니다. 요청 작성 시 실행자 변경이 불가능합니다.
        * [DB Connections](DB Connections)에서 DB 커넥션 별로 Connection Owner를 지정하는 방법을 확인할 수 있습니다.
    * **Select Assignees**  : 현재 선택하는 사용자 또는 그룹만이 실행자로 지정되며, 요청 작성 시 실행자 변경이 불가능합니다.
* **Urgent Mode**  : 해당 결재 규칙 하에서 사후 승인(Urgent Mode)을 허용할지 결정합니다.
    * 기본값은 비허용(Off)이며, 추후 Approval Rule 수정을 통해 On/Off 가능합니다.
    * Workflow Configurations에서 사후 승인이 허용되어 있어야만 이 옵션이 표시됩니다.
* **Allow Self-Approval**  : 해당 결재 규칙(Approval Rule)하에서 요청자가 자신을 승인자로 지정하거나 자신의 요청을 직접 승인하는 것을 허용할지 결정합니다.
    1. **워크플로우 상신 페이지**
        1. **주의** :
            * 특정 요청 상신 후에 자가 승인 규칙이 변경되더라도, 이미 상신된 요청에는 소급하여 적용되지 않습니다.
        2. **Allow Assignee selection (Admin-Only) ** :
            * 활성화 시: 워크플로우 상신 페이지에서 요청자 본인을 승인자로 지정할 수 있습니다.
            * 비활성화 시: 워크플로우 상신 페이지에서 승인자 선택 목록에서 요청자 본인이 제외됩니다.
        3. **Allow Assignee selection (All Users)**  :
            * 활성화 시: 워크플로우 상신 페이지에서 요청자 본인을 승인자로 지정할 수 있습니다.
            * 비활성화 시: 워크플로우 상신 페이지에서 승인자 선택 목록에서 요청자 본인이 제외됩니다.
        4. **Select Assignees**  :
            1. 승인 규칙에 요청자 자신만 Approver로 설정된 경우:
                * 활성화 시: 워크플로우 상신 페이지에서 요청자 본인을 승인자로 지정할 수 있습니다.
                * 비활성화 시: 해당 Approval Rule은 상신자 페이지 화면에 표시되지만, 선택하여 상신 시 에러가 발생합니다.
            2. 승인 규칙에 요청자 본인이 포함된 그룹이 Approver로 설정된 경우:
                * 활성화 시: 워크플로우 상신 페이지에서 요청자 본인을 승인자로 지정할 수 있습니다.
                * 비활성화 시: 요청자는 승인자 목록에 포함되어 표시됩니다. 상신은 가능하지만, 실제 승인자 화면에서는 요청자 본인의 이름이 제외되며 나머지 그룹 구성원들만 Approver로 등록됩니다.
        5. **Assign Connection Owner ** :
            * 활성화 시: 본인이 포함된 경우 자동으로 본인이 승인자로 지정됩니다.
            * 비활성화 시: Owner에 요청자 본인이 포함되어 있더라도 요청 상신 페이지의 승인자 목록에 표시되지 않습니다.
        6. **Assign Server Group Owners :**
            * 활성화 시: 본인이 포함된 경우 자동으로 본인이 승인자로 지정됩니다.
            * 비활성화 시: Owner에 요청자 본인이 포함되어 있더라도 요청 상신 페이지의 승인자 목록에 표시되지 않습니다.
    2. **워크플로우 승인 페이지**
        1. **신규 옵션 비활성화 시:**
            * 요청자 본인이 승인자로 지정된 경우, `Approve` 버튼을 클릭하면 오류 메시지가 표시되며 자가 승인이 불가능합니다.
        2. **신규 옵션 활성화 시:**
            * 요청자 본인이 승인자로 지정된 경우, `Approve` 버튼을 클릭하면 자가 승인이 가능합니다
* **Allow submitting requests for others**  : 사용자가 다른 사용자를 대신하여 워크플로우 요청을 제출할 수 있도록 허용합니다 (대리 상신).
    * 이 기능은 Request Type이 `DB Access Request`, `Unmasking Request`, `Restricted Data Access Request`, `DB Policy Exception Request`, `Decryption Request`인 경우에만 활성화됩니다.
    * `Allow submitting requests for others` 옵션이 활성화된 결재 규칙을 선택하면, 요청 상신 화면에 결재를 적용받을 실제 대상 사용자를 지정하는 `Target User` 항목이 표시됩니다.
* 입력을 마쳤다면 `OK` 버튼을 클릭하여 결재 규칙 생성을 완료합니다.



## 결재 규칙 확인 및 수정하기
Administrator &gt; General &gt; Workflow Management &gt; Approval Rules 내 결재 규칙 목록 중 상세 내용을 확인 및 수정하려는 아이템을 클릭하여, 모달을 엽니다.

<p align="center">
<div>[image-20250512-121540.png]()</div>
*Administrator &gt; General &gt; Workflow Management &gt; Approval Rules &gt; Update Approval Rule*
</p>

* 생성 시 입력된 항목 중  **Request Type**  을 제외한 모든 항목이 변경 가능합니다.
* 변경을 마쳤다면 `OK` 버튼을 클릭하여 결재 규칙 수정을 완료합니다. (변경된 내용이 없더라도 업데이트 처리됨)
* 변경을 취소하거나, 또는 업데이트 없이 모달을 닫으려면 `Cancel` 버튼을 눌러 모달을 닫고 나갑니다.

## 결재 규칙 삭제하기
Administrator &gt; General &gt; Workflow Management &gt; Approval Rules 목록에서 결재 규칙을 삭제할 수 있습니다.

<p align="center">
<div>[스크린샷 2024-07-25 오후 4.54.23.png]()</div>
*Administrator &gt; General &gt; Workflow Management &gt; Approval Rules (삭제 활성화)*
</p>

1. 삭제하려는 결재 규칙을 체크박스로 선택한 뒤 테이블 헤더에 노출되는 `Delete` 버튼을 클릭합니다.
2. 삭제 확인 모달에서 `OK` 버튼을 클릭하면 삭제가 완료됩니다.
