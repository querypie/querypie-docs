---
title: 'Server Privilege Request の申請'
---

import { Callout } from 'nextra/components'

## Overview

Server Privilege Requestを使用すると、サーバーに対する一時的なコマンド使用権限を簡単に要求できます。一時的なコマンド使用時間と権限開始時点（承認即時またはサーバー接続時点から）を選択申請できます。この機能はSSHプロトコル通信のみサポートします。

## Server Privilege Request

### 1. 承認ルールの選択

* Approval Ruleを選択して目的に合った承認ルールを選択してください。選択したルールに応じて承認対象が異なります。
* 管理者が承認者を指定した承認ルールが選択された場合、自動的に承認者が指定され、追加や変更はできません。
*  **Approval Expiration Date** : 承認有効期限を入力します。Maximum Approval Durationを通じて最大値を設定できます。Approval Expiration DateはPrivilege Expiration Dateを超えることはできません。超えた場合、申請できません。Maximum Approval Duration &gt; Maximum Access Durationの場合、Maximum Approval Durationの値がMaximum Access Durationの値と同等に適用されます。例）Maximum Approval Durationが14日でMaximum Access Durationが5日の場合、Maximum Approval Durationの値も5日で適用されます。
    * ただし、Urgent Modeで申請する場合、上記条件を無視します。

<figure data-layout="center" data-align="center">
![Screenshot-2025-08-26-at-12.54.02-AM.png](/user-manual/workflow/requesting-server-privilege/Screenshot-2025-08-26-at-12.54.02-AM.png)
</figure>

### 2. 承認者の指定

* 承認ラインで`+`ボタンを押すと、段階別承認者を指定できるポップアップが表示されます。
* このポップアップで承認条件と承認者を追加後、`Save`ボタンを押して承認ラインを保存します。
* 選択可能な承認条件は以下の通りです。
    *  **A single Assignee can complete the approval request**  : 複数名の中の一人の承認だけで承認要求が承認処理されます。
    *  **All Assignees must approve this request**  : すべての承認者が承認して初めて承認要求が承認処理されます。

<figure data-layout="center" data-align="center">
![image-20240807-130021.png](/user-manual/workflow/requesting-server-privilege/image-20240807-130021.png)
</figure>

### 3. 参照者の指定

* 承認ラインで`+`ボタンを押すと、参照者を指定できるポップアップが表示されます。
    * 管理者が参照者指定を許可していない場合、Reviewerボックスは表示されません。
* このポップアップで承認条件と承認者を追加します。
* `Save`ボタンを押してモーダルを閉じ、参照者指定を完了します。

<figure data-layout="center" data-align="center">
![screenshot-20240807-215819.png](/user-manual/workflow/requesting-server-privilege/screenshot-20240807-215819.png)
</figure>

### 4. 事後承認で要求を送信

* 事後承認機能が許可された承認ルールを選択した場合、Urgent Modeスイッチが表示されます。
* Urgent mode = Onに設定後、承認要求を登録すると即座に権限を付与されたり作業を実行できます。

<figure data-layout="center" data-align="center">
![image-20240807-125848.png](/user-manual/workflow/requesting-server-privilege/image-20240807-125848.png)
</figure>

<Callout type="important">
**Q. Urgent Modeスイッチが表示されません。**
A. 管理者がUrgent Modeを許可していない承認ルールを選択した場合、該当機能は表示されません。
</Callout>


### 5. 要求対象Roleの選択

* Role下部のselect boxをクリックします。
* ユーザーに付与されたRoleの中から一つを選択します。

<figure data-layout="center" data-align="center">
![image-20250307-123347.png](/user-manual/workflow/requesting-server-privilege/image-20250307-123347.png)
</figure>

### 6. 要求対象サーバーの選択

* Server List右側の`Add Server`をクリックすると、サーバーを選択できるポップアップが表示されます。
* 選択可能なサーバーは「5. 要求対象Roleの選択」で選択したRoleによって異なります。
* `Add`ボタンをクリックしてモーダルを閉じ、サーバー選択を完了します。

<figure data-layout="center" data-align="center">
![image-20250307-123829.png](/user-manual/workflow/requesting-server-privilege/image-20250307-123829.png)
</figure>

### 7. 使用するCommandsの入力

* 管理者の設定によってコマンド入力方式が異なります。
* Command Template直接入力時
    * 管理者がAllow Pre-defined Command Templates Onlyオプションを無効にした場合、Commands入力欄が表示されます。一時使用を申請するコマンドを入力します。
    *  **Commands** に一時使用を申請するコマンドを入力します。
        *  **Keyword**  : コマンドをキーワードで入力できます。
        *  **RegEx**  : コマンドを正規表現形式で入力できます。<br/>

* Command Template選択時
    * 管理者がAllow Pre-defined Command Templates Onlyオプションを有効にした場合、Commandsを直接入力する代わりにCommand Template選択ボックスが表示されます。
        1. ドロップダウンリストから使用する権限が含まれたテンプレートを選択します。
        2. テンプレートを選択すると、含まれるコマンド（Keyword、RegEx）が画面に表示されますが、直接修正はできません。<br/>

<Callout type="info">
**Q. 選択できるテンプレートがないと表示されます。**
A. 管理者がワークフローで使用するよう許可したテンプレートがない場合です。管理者に設定確認要求をする必要があります。
</Callout>

<Callout type="info">
**要求にLinux以外のサーバーのみが含まれる場合**
要求対象がWindowsサーバーのようにLinux以外のサーバーで만 구성된場合、この要求は特定のコマンド使用ではなく、サーバーに対する一時的な接続権限を得ることを目的とします。したがって、Commandsを入力または選択するフィールドは画面に表示されません。
</Callout>

### 8. Server Privilege使用時間の入力

#### Require Minute-Based RequestsOnの場合

<figure data-layout="center" data-align="center">
![Screenshot-2025-08-26-at-1.05.08-AM.png](/user-manual/workflow/requesting-server-privilege/Screenshot-2025-08-26-at-1.05.08-AM.png)
</figure>

*  **Start Trigger**  : 権限付与開始条件を選択します。
    * Access to the Server : Server Privilege適用後、適用されたユーザーがサーバー接続開始から時間をカウントします。
    * Grant : Server Privilege付与時点からServer Privilege使用可能時間をカウントします。Requestが承認されるとQueryPieで自動的にServer Privilegeを付与します。
*  **Duration(Minutes)** : Server Privilege適用時間を設定します。分単位で時間を入力できます。Privilege Start Triggerによって開始する時点が異なります。

#### Require Minute-Based RequestsOffの場合

<figure data-layout="center" data-align="center">
![Screenshot-2025-08-26-at-1.14.48-AM.png](/user-manual/workflow/requesting-server-privilege/Screenshot-2025-08-26-at-1.14.48-AM.png)
</figure>

*  **Privilege Expiration Date**  : 要求権限の有効期限を入力します。基本値は管理者ページのSAC configurations &gt; Server Privilege Request SettingsのMaximum Access Duration値に従います。
    * 適切な接続アクセス権限管理のために必要な期間だけ要求することを推奨します。

### 9. 要求情報の入力

*  **Title**  : 要求タイトルを入力します。
*  **Reason for Request**  : 接続アクセス権限を要求する理由を入力します。
*  **Submit**  : 要求をすべて作成したら`Submit`ボタンを押して申請を完了します。

<figure data-layout="center" data-align="center">
![image-20250307-124047.png](/user-manual/workflow/requesting-server-privilege/image-20250307-124047.png)
</figure>


アクセス権限を付与されたサーバーに接続する方法は、[権限のあるサーバーに接続する](../server-access-control/connecting-to-authorized-servers)文書を参照してください。
