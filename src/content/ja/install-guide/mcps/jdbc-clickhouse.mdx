# ClickHouse

ClickHouseデータベースに接続して高性能分析クエリを実行できます。

## 主な機能
- 高性能分析クエリの実行
- カラム型データベースの最適化
- 大容量データ処理
- リアルタイムデータ分析
- 集計関数とウィンドウ関数のサポート
- 読み取り専用モードのサポート

## 基本情報

### 認証方式
ユーザー名/パスワードを使用して認証します。

### 入力パラメータ
- **Host** (必須): ClickHouseサーバーホスト
- **Port** (必須): ClickHouseサーバーポート（デフォルト: 8123）
- **Username** (必須): ClickHouseユーザー名
- **Password** (必須): ClickHouseパスワード
- **Database** (オプション): 接続するデータベース名（デフォルト: default）
- **Connection Timeout** (オプション): 接続タイムアウト時間（デフォルト: 30000ms、最大: 60000ms）
- **Use SSL** (オプション): SSL接続を使用するかどうか
- **Read Only** (オプション): 読み取り専用モードを有効にするかどうか

## サポートされているMCPツール

### execute_sql
ClickHouseデータベースでSQLクエリを実行し、結果を返します。

**読み取り専用モード**では、以下のSQLコマンドのみが許可されます：
- `SELECT` - データの照会
- `WITH` - CTE（Common Table Expression）の使用
- `EXPLAIN` - クエリ実行計画の照会
- `ANALYZE` - クエリ分析
- `SHOW` - メタデータの照会

**結果制限**: パフォーマンス上の理由により、最大500行まで返されます。

例えば、
- プロンプトで「ユーザーテーブルのデータを照会して」と入力すると、
- LLMはMCPを通じて`SELECT * FROM users`クエリを実行します。
- そして、ツール呼び出し結果に基づいてチャットで応答します。

## ClickHouse接続設定方法
1. ClickHouseサーバーにアクセス可能なユーザーアカウントを準備します。
2. 必要なデータベース権限を付与します。
3. ネットワークアクセス権限を設定します。
4. QueryPie AIでClickHouse統合を選択します。
5. 接続情報を入力して設定を完了します。

## 注意事項
- ClickHouseユーザーアカウントのパスワードは安全に保管してください。
- 必要最小限のデータベース権限のみを付与することを推奨します。
- 本番環境ではSSL接続を使用することを推奨します。
- 大容量クエリ結果は500行に制限されるため、適切なLIMIT句を使用してください。
- 読み取り専用モードを有効にしてデータ変更を防ぐことができます。 