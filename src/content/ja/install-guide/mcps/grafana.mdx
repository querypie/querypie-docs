# Grafana

Grafanaと接続して、監視ダッシュボードとアラートを管理できます。

## 主な機能
- ダッシュボードの確認、作成、修正
- データソース管理と作成
- アラートルール設定と管理
- Prometheusメトリクスクエリ実行
- システムヘルスチェック
- ダッシュボード検索機能

## 基本情報

### 認証方式
API Keyを使用して認証します。

### 入力パラメータ
- **API Key**（必須）：Grafanaで生成したAPIキー
- **Grafana URL**（必須）：GrafanaインスタンスURL

## サポートするMCPツール

### ダッシュボード管理
#### get_dashboard_by_uid
UIDで識別される特定のダッシュボードの完全な情報を取得します（パネル、変数、設定を含む）。

#### update_dashboard
ダッシュボードを作成または更新します。

#### get_dashboard_panel_queries
ダッシュボードの各パネルに対するタイトル、クエリ文字列、データソース情報を取得します。

#### search_dashboards
クエリを使用してダッシュボードを検索します。

### アラート管理
#### create_alert_rule
新しいGrafanaアラートルールを作成します。

#### list_alert_rules
Grafanaアラートルールのリストを取得します。UID、タイトル、現在の状態、ラベルなどの要約情報を返します。

#### get_alert_rule_by_uid
一意のID（UID）で識別される特定のGrafanaアラートルールの完全な構成と詳細状態を取得します。

### データソース管理
#### list_datasources
利用可能なGrafanaデータソースのリストを取得します。データソースタイプでフィルタリングできます。

#### get_datasource_by_uid
UIDを使用して特定のデータソースの詳細情報を取得します。

#### get_datasource_by_name
名前を使用して特定のデータソースの詳細情報を取得します。

#### create_datasource
新しいGrafanaデータソースを作成します。

### Prometheusクエリ
#### query_prometheus
PromQL式を使用してPrometheusをクエリします。即時クエリと範囲クエリの両方をサポートします。

#### list_prometheus_metric_metadata
Prometheusメトリクスメタデータのリストを取得します。現在のターゲットから収集されたメトリクスに関するメタデータを返します。

#### list_prometheus_metric_names
Prometheusデータソースのメトリクスネームリストを取得します。正規表現を使用したフィルタリングとページネーションをサポートします。

#### list_prometheus_label_names
Prometheusデータソースのラベルネームリストを取得します。シリーズセレクターと時間範囲でフィルタリングできます。

#### list_prometheus_label_values
Prometheusで特定のラベル名の値を取得します。シリーズセレクターと時間範囲でフィルタリングできます。

### システム管理
#### check_health
Grafanaインスタンスのヘルス状態を確認します。コミットハッシュ、データベース状態、バージョン情報を返します。

## 使用例

例えば、
- プロンプトで「現在登録されているダッシュボードのリストを確認して」と入力すると、
- LLMはMCPを通じて`search_dashboards`ツールを呼び出し、ダッシュボードリストを取得します。
- そして、ツール呼び出し結果に基づいてチャットで応答します。

## APIキー生成方法
1. Grafanaインスタンスに管理者権限でログインします。
2. Configuration > API Keysで新しいAPIキーを生成します。
3. 必要な権限を設定します。

## 注意事項
- 生成したAPIキーは安全に保管してください。
- 必要最小限の権限のみを付与することを推奨します。
- Grafana URLはHTTPSを使用することを推奨します。
- 大容量ダッシュボードJSONはコンテキストウィンドウを消費する可能性があるため注意してください。
- Prometheusメトリクスメタデータエンドポイントは実験的機能です。 